import{j as e}from"./jsx-runtime.DobA4Wei.js";import{g as m}from"./getTokenFromSession.BIEqYT4d.js";import{r as d}from"./index.vg6u8O4B.js";import{A as c,u,J as f}from"./useAuth.BG33Pi0N.js";import"./auth.Bit6wUPJ.js";import"./index.C0vfKdQK.js";const x="http://localhost:3001";async function p(s,a){const r=`Bearer ${s}`;try{const o=await(await fetch(`${x}/forum/create`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:r},body:JSON.stringify(a)})).json();if(!o.error)return o;throw new Error(o.error)}catch(t){throw console.log(t),t}}function g({open:s}){const[a,r]=d.useState({title:"",description:""}),t=l=>{if(!l.target)return;const{value:n,name:i}=l.target;r(h=>({...h,[i]:n}))},o=async l=>{l.preventDefault();const n=m();if(!n)return;await p(n,a)?c.success("El foro se ha creado correctamente"):c.error("Hubo algún problema para crear el foro..."),setTimeout(()=>{window.location.reload()},2100)};return e.jsxs("form",{onSubmit:o,className:"flex flex-col gap-2 my-3 items-start",style:{height:`${s?"220px":"0"}`,overflow:"hidden",transition:"all .2s"},children:[e.jsxs("label",{className:"w-full",children:[e.jsx("p",{className:"block font-semibold",children:"Título..."}),e.jsx("input",{onChange:t,name:"title",className:"p-3 w-full rounded-lg",type:"text",placeholder:"Escribe el título del foro..."})]}),e.jsxs("label",{className:"w-full",children:[e.jsx("p",{className:"block font-semibold",children:"Descripción..."}),e.jsx("input",{onChange:t,name:"description",className:"p-3 w-full rounded-lg",type:"text",placeholder:"Escribe la descripción del foro..."})]}),e.jsx("button",{className:"bg-green-700 p-2 px-6 mt-3 rounded-lg text-white font-semibold",children:"Listo"})]})}const w="http://localhost:3001";async function j(s,a){const r=`Bearer ${a}`;try{return await(await fetch(`${w}/forum/${s}`,{method:"DELETE",headers:{Authorization:r}})).json()}catch(t){throw console.error(t),t}}function b({title:s,description:a,id:r}){const{isAdmin:t}=u(),o=async()=>{if(!confirm("¿Estás seguro de que quieres elminar este foro?"))return;const n=m();if(!n)return;const i=await j(String(r),n);console.log(i),i.msg?c.success("El foro se ha eliminado correctamente."):c.error("Fatal, hubo un error al tratar de elminar el foro."),setTimeout(()=>{window.location.reload()},2e3)};return e.jsxs("div",{className:"relative",children:[t&&e.jsx("button",{onClick:o,className:"text-red-500 absolute top-2 right-2 z-99 hover:scale-[1.1] transition-transform cursor-pointer",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"22",height:"22",fill:"currentColor",className:"bi bi-x-square-fill",viewBox:"0 0 16 16",children:e.jsx("path",{d:"M2 0a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2zm3.354 4.646L8 7.293l2.646-2.647a.5.5 0 0 1 .708.708L8.707 8l2.647 2.646a.5.5 0 0 1-.708.708L8 8.707l-2.646 2.647a.5.5 0 0 1-.708-.708L7.293 8 4.646 5.354a.5.5 0 1 1 .708-.708"})})}),e.jsx("a",{href:`/foros/${s}`,children:e.jsxs("div",{className:"w-full h-[90px] text-base rounded-2xl bg-white p-3 flex justify-between gap-4 items-center",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-[75px]",children:e.jsx("img",{src:"/img/mundi.jpg",alt:"Planeta Tierra",className:"w-full h-full object-cover rounded-full"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold",children:s}),e.jsx("p",{className:"text-gray-800 text-sm hidden lg:block",children:a})]})]}),e.jsx("div",{className:"text-sm flex flex-col gap-2 justify-center items-center"})]})})]})}function T({forums:s}){const{isAdmin:a}=u(),[r,t]=d.useState(!1),o=()=>{t(!r)};return e.jsxs("section",{id:"forum-section",className:"flex-[0.6]",children:[a&&e.jsxs("div",{className:"mt-6",children:[e.jsxs("button",{onClick:o,className:"hover:bg-emerald-600 w-full bg-green-600 text-white p-3 rounded-xl font-medium flex justify-center items-center gap-2",children:["Crear foro",e.jsx("span",{children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",className:"bi bi-plus-square-fill",viewBox:"0 0 16 16",children:e.jsx("path",{d:"M2 0a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2zm6.5 4.5v3h3a.5.5 0 0 1 0 1h-3v3a.5.5 0 0 1-1 0v-3h-3a.5.5 0 0 1 0-1h3v-3a.5.5 0 0 1 1 0"})})})]}),e.jsx(g,{open:r})]}),e.jsx("div",{className:"pb-3 lg:pb-0 flex flex-row overflow-x-scroll lg:overflow-x-hidden lg:flex-col gap-3 mt-10",children:s.length>0?s.map(l=>e.jsx(b,{title:l.title,description:l.description,id:l.id},l.id)):e.jsx("p",{className:"font-bold text-center w-full text-sm",children:"Todavía no hay ningún foro..."})}),e.jsx(f,{richColors:!0,position:"bottom-left",expand:!0})]})}export{T as default};
